<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Easy Blog</title>
    <meta name="description" content="Easy Blog - By Ahmadz.ai"/>
    <link rel="stylesheet" href="{% static 'css/themes.css' %}">
    <link rel="stylesheet" href="{% static 'css/base.css' %}">
    <link rel="stylesheet" href="{% static 'css/messages.css' %}">
    <link rel="stylesheet" href="{% static 'css/prism.css' %}">

    {% block styles %}
    {% endblock %}

    <link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/default.min.css">

    <script src="{% static 'js/theme.js' %}"></script>
</head>
<body class="dark">
<script>applyTheme(document.body)</script>
<nav>
    <div id="navbar">
        <div id="leftnav">
            <a href="{% url 'home' %}">Easy Blog</a>
        </div>
        <form action="{% url 'search' %}" id="search_bar">
                <input type="text" aria-label="search" name="q" placeholder="Search">
        </form>
        <div style="display: flex; align-items: center;">
            <a href="{% url 'new_post' %}">Write</a>
            <a href="javascript:void(0);" id="dropdown_btn" onclick="toggle('navlinksContainer', 'flex')">
                {% if user.is_authenticated %}
                    <img class="avatar_icon" src="{{aws_media_url}}{{user.profile.avatar}}" alt="">
                {%else %}
                    <ion-icon name="menu-outline"></ion-icon>
                {% endif %}
                <ion-icon name="caret-down-outline"></ion-icon>
            </a>
        </div>
    </div>
    <div id="navlinksContainer">
        <div id="navLinks">
            <a onclick="SwitchTheme()"><div>Switch Theme <ion-icon name="contrast-outline"></ion-icon></div></a>
            {% if user.is_authenticated %}
                <a href="{% url 'profile_page' user.username %}"><div>{{user.username}}</div></a>
                <a href="{% url 'logout' %}"><div>Logout</ion-icon></div></a>
            {% else %}
                <a href="{% url 'signup' %}"><div>Sign Up</div></a>
                <a href="{% url 'login' %}"><div>Log In</div></a>
            {% endif %}
        </div>
    </div>
</nav>

<div id="injectedContainer">
    {% block messages %}
        <ul class="messages" id="messages-list">
        {% if messages %}
            {% for message in messages %}
            <li>
                {% if message.tags %}
                     <div class="alert alert-{{ message.tags }} msg fade show" role="alert">{{ message }}</div>
                {% else %}
                    <div class="alert alert-info msg fade show" role="alert">{{ message }}</div>
                {% endif %}
            </li>
            {% endfor %}
        {% endif %}
        </ul>
    {% endblock %}
    {% block content %}
        <!-- Content Goes here -->
    {% endblock content %}
</div>

</body>
<script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
<script src="{% static 'js/prism.js' %}"></script>
<script src="{% static 'js/main.js' %}"></script>
<script>
	window.addEventListener('message', function(e) {
		let message = e.data;
        if (message.iframeID && message.height) {
            let ifr = document.querySelector(`iframe#${message.iframeID}`);
            if (ifr) ifr.style.height = message.height + 'px';
        }
	} , false);
</script>
<script src="{% static 'js/requests.js' %}"></script>
{% block scripts %}
{% endblock %}
</html>